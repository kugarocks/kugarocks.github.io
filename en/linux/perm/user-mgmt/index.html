<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=https://www.kugarocks.com/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://www.kugarocks.com/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://www.kugarocks.com/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script><link rel=stylesheet href="/main.cf35a17480385a663e8443e34eaacdc3cf6077ea02b413da2597d488a5058946cead5f5ba298e99ef64c83856f3f791d5ecf5464e8650639faf4c874ff7b017d.css" integrity="sha512-zzWhdIA4WmY+hEPjTqrNw89gd+oCtBPaJZfUiKUFiUbOrV9bopjpnvZMg4VvP3kdXs9UZOhlBjn69Mh0/3sBfQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=https://www.kugarocks.com/en/linux/perm/user-mgmt/><link rel=canonical href=https://www.kugarocks.com/en/linux/perm/user-mgmt/><link rel=alternate hreflang=zh-hk href=https://www.kugarocks.com/zh-hk/linux/perm/user-mgmt/><link rel=alternate hreflang=zh-cn href=https://www.kugarocks.com/zh-cn/linux/perm/user-mgmt/><link rel=alternate hreflang=x-default href=https://www.kugarocks.com/zh-cn/linux/perm/user-mgmt/><link rel=alternate hreflang=en href=https://www.kugarocks.com/en/linux/perm/user-mgmt/><title>User Management</title>
<meta name=description content="Congrats on setting up a new Doks project!"><link rel=icon href=/favicon.ico sizes=32x32><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=manifest href=/manifest.webmanifest><meta property="og:title" content="User Management"><meta property="og:description" content="User Account
/etc/passwd
Linux uses the /etc/passwd file to store user account information.
Because many service processes need to read user account information, you can see that the file&rsquo;s permissions are all readable."><meta property="og:type" content="article"><meta property="og:url" content="https://www.kugarocks.com/en/linux/perm/user-mgmt/"><meta property="og:image" content="https://www.kugarocks.com/cover.png"><meta property="article:section" content="linux"><meta property="article:published_time" content="2024-08-27T20:00:00+08:00"><meta property="article:modified_time" content="2024-08-28T20:00:00+08:00"><meta property="og:site_name" content="My Docs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.kugarocks.com/cover.png"><meta name=twitter:title content="User Management"><meta name=twitter:description content="User Account
/etc/passwd
Linux uses the /etc/passwd file to store user account information.
Because many service processes need to read user account information, you can see that the file&rsquo;s permissions are all readable."><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://www.kugarocks.com/en/","name":"Mini Rocks","position":1},{"@type":"ListItem","item":"https://www.kugarocks.com/en/linux/","name":"Linux","position":2},{"@type":"ListItem","item":"https://www.kugarocks.com/en/linux/perm/","name":"Permission Management","position":3},{"@type":"ListItem","name":"User Management","position":4}]}</script></head><body class="single section linux" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=/en/>kugarocks</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
<svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Linux</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><nav class="section-nav docs-links"><ul class=list-unstyled><li><a href=/en/linux/readme/>README</a></li><li><a href=/en/linux/say-my-name/>Chapter 1: Say My Name</a></li><li><a href=/en/linux/terminal/>Chapter 2: Terminal</a></li><li><details><summary>Chapter 3: Shell</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/shell/intro/>Shell Introduction</a></li><li><a href=/en/linux/shell/command-history/>Command History</a></li><li><a href=/en/linux/shell/basic-operations/>Basic Operations</a></li><li><a href=/en/linux/shell/command-type/>Command Type</a></li><li><a href=/en/linux/shell/shell-variables/>Shell Variables</a></li><li><a href=/en/linux/shell/subshell/>Subshell</a></li></ul></details></li><li><details><summary>Chapter 4: Commands</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/cmd/common-1/>Commands-1</a></li><li><a href=/en/linux/cmd/common-2/>Commands-2</a></li><li><a href=/en/linux/cmd/grep/>GREP</a></li><li><a href=/en/linux/cmd/ps/>PS</a></li><li><a href=/en/linux/cmd/top/>Top</a></li><li><a href=/en/linux/cmd/terminate/>Terminate Processes</a></li><li><a href=/en/linux/cmd/compression/>Compression</a></li></ul></details></li><li><details><summary>Chapter 5: Environment</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/env/concept/>Concept</a></li><li><a href=/en/linux/env/shell-startup/>Shell Startup Process</a></li><li><a href=/en/linux/env/variables/>Environment Variables</a></li><li><a href=/en/linux/env/shebang/>Shebang</a></li></ul></details></li><li><details open><summary>Chapter 6: Permission</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/en/linux/perm/user-mgmt/>User Management</a></li><li><a href=/en/linux/perm/group-mgmt/>Group Management</a></li><li><a href=/en/linux/perm/file-perm/>File Permission</a></li><li><a href=/en/linux/perm/acl/>Access Control List</a></li></ul></details></li><li><details><summary>Chapter 7: Process</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/proc/systemd/>Systemd</a></li><li><a href=/en/linux/proc/fd/>File Descriptor</a></li><li><a href=/en/linux/proc/pipe/>Pipe</a></li><li><a href=/en/linux/proc/lsof/>LSOF</a></li><li><a href=/en/linux/proc/ulimit/>ULIMIT</a></li></ul></details></li><li><a href=/en/linux/file-system/>Chapter 8: File System</a></li><li><details><summary>Chapter 9: Shell Script</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/script/syntax/>Basic Syntax</a></li><li><a href=/en/linux/script/cond/>Condition</a></li><li><a href=/en/linux/script/loop/>Loop</a></li><li><a href=/en/linux/script/input/>Input</a></li><li><a href=/en/linux/script/output/>Output</a></li><li><a href=/en/linux/script/signal/>Signal</a></li><li><a href=/en/linux/script/func/>Function</a></li><li><a href=/en/linux/script/param-exp/>Parameter Expansion</a></li><li><a href=/en/linux/script/special-params/>Special Parameters</a></li></ul></details></li><li><details><summary>Chapter 10: Text Processing</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/text/multi-lines/>Multi-Lines Text</a></li><li><a href=/en/linux/text/regex/>Regular Expression</a></li><li><a href=/en/linux/text/sed/>SED</a></li><li><a href=/en/linux/text/gawk-1/>GAWK-1</a></li><li><a href=/en/linux/text/gawk-2/>GAWK-2</a></li></ul></details></li><li><details><summary>Appendix</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/appendix/term-1/>Terms - 1</a></li></ul></details></li></ul></nav></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>kugarocks</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class=nav-link href=https://www.kugarocks.com/en/tech/readme/>Tech</a></li><li class=nav-item><a class="nav-link active" href=https://www.kugarocks.com/en/linux/readme/ aria-current=true>Linux</a></li><li class=nav-item><a class=nav-link href=https://www.kugarocks.com/en/toys/readme/>Toys</a></li><li class=nav-item><a class=nav-link href=https://www.kugarocks.com/en/about/>About</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button><div class="dropdown mt-1 order-lg-2"><button class="btn btn-dropdown dropdown-toggle" id=doks-languages data-bs-toggle=dropdown aria-expanded=false data-bs-display=static>
<span class=dropdown-caret><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c0 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<span id=doks-language-current>English</span><svg class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6 6-6"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-languages><li><span class="dropdown-item current" aria-current=true>English</span></li><li><hr class=dropdown-divider></li><li><a class=dropdown-item rel=alternate href=/zh-cn/linux/perm/user-mgmt/ hreflang=zh-cn lang=zh-cn>简体中文</a></li><li><a class=dropdown-item rel=alternate href=/zh-hk/linux/perm/user-mgmt/ hreflang=zh-hk lang=zh-hk>繁体中文(香港)</a></li></ul></div><button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://github.com/kugarocks><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=UTF-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class="submitted d-none"><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class="section-nav docs-links"><ul class=list-unstyled><li><a href=/en/linux/readme/>README</a></li><li><a href=/en/linux/say-my-name/>Chapter 1: Say My Name</a></li><li><a href=/en/linux/terminal/>Chapter 2: Terminal</a></li><li><details><summary>Chapter 3: Shell</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/shell/intro/>Shell Introduction</a></li><li><a href=/en/linux/shell/command-history/>Command History</a></li><li><a href=/en/linux/shell/basic-operations/>Basic Operations</a></li><li><a href=/en/linux/shell/command-type/>Command Type</a></li><li><a href=/en/linux/shell/shell-variables/>Shell Variables</a></li><li><a href=/en/linux/shell/subshell/>Subshell</a></li></ul></details></li><li><details><summary>Chapter 4: Commands</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/cmd/common-1/>Commands-1</a></li><li><a href=/en/linux/cmd/common-2/>Commands-2</a></li><li><a href=/en/linux/cmd/grep/>GREP</a></li><li><a href=/en/linux/cmd/ps/>PS</a></li><li><a href=/en/linux/cmd/top/>Top</a></li><li><a href=/en/linux/cmd/terminate/>Terminate Processes</a></li><li><a href=/en/linux/cmd/compression/>Compression</a></li></ul></details></li><li><details><summary>Chapter 5: Environment</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/env/concept/>Concept</a></li><li><a href=/en/linux/env/shell-startup/>Shell Startup Process</a></li><li><a href=/en/linux/env/variables/>Environment Variables</a></li><li><a href=/en/linux/env/shebang/>Shebang</a></li></ul></details></li><li><details open><summary>Chapter 6: Permission</summary><ul class="list-unstyled list-nested"><li class=active><a aria-current=page href=/en/linux/perm/user-mgmt/>User Management</a></li><li><a href=/en/linux/perm/group-mgmt/>Group Management</a></li><li><a href=/en/linux/perm/file-perm/>File Permission</a></li><li><a href=/en/linux/perm/acl/>Access Control List</a></li></ul></details></li><li><details><summary>Chapter 7: Process</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/proc/systemd/>Systemd</a></li><li><a href=/en/linux/proc/fd/>File Descriptor</a></li><li><a href=/en/linux/proc/pipe/>Pipe</a></li><li><a href=/en/linux/proc/lsof/>LSOF</a></li><li><a href=/en/linux/proc/ulimit/>ULIMIT</a></li></ul></details></li><li><a href=/en/linux/file-system/>Chapter 8: File System</a></li><li><details><summary>Chapter 9: Shell Script</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/script/syntax/>Basic Syntax</a></li><li><a href=/en/linux/script/cond/>Condition</a></li><li><a href=/en/linux/script/loop/>Loop</a></li><li><a href=/en/linux/script/input/>Input</a></li><li><a href=/en/linux/script/output/>Output</a></li><li><a href=/en/linux/script/signal/>Signal</a></li><li><a href=/en/linux/script/func/>Function</a></li><li><a href=/en/linux/script/param-exp/>Parameter Expansion</a></li><li><a href=/en/linux/script/special-params/>Special Parameters</a></li></ul></details></li><li><details><summary>Chapter 10: Text Processing</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/text/multi-lines/>Multi-Lines Text</a></li><li><a href=/en/linux/text/regex/>Regular Expression</a></li><li><a href=/en/linux/text/sed/>SED</a></li><li><a href=/en/linux/text/gawk-1/>GAWK-1</a></li><li><a href=/en/linux/text/gawk-2/>GAWK-2</a></li></ul></details></li><li><details><summary>Appendix</summary><ul class="list-unstyled list-nested"><li><a href=/en/linux/appendix/term-1/>Terms - 1</a></li></ul></details></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><a href=#user-account>User Account</a><ul><li><a href=#etcpasswd>/etc/passwd</a></li><li><a href=#etcshadow>/etc/shadow</a></li></ul></li><li><a href=#useradd>Useradd</a><ul><li><a href=#home-directory>HOME Directory</a></li><li><a href=#default-configuration>Default Configuration</a></li><li><a href=#etcdefaultuseradd>/etc/default/useradd</a></li><li><a href=#etclogindefs>/etc/login.defs</a></li><li><a href=#modify-conf-by-cmd>Modify Conf By Cmd</a></li></ul></li><li><a href=#usermod>Usermod</a><ul><li><a href=#modify-user-login-name>Modify User Login Name</a></li><li><a href=#add-user-to-a-group>Add User to a Group</a></li><li><a href=#modify-user-default-shell>Modify User Default Shell</a></li><li><a href=#modify-user-id>Modify User ID</a></li></ul></li><li><a href=#passwd>Passwd</a><ul><li><a href=#modify-current-user-pwd>Modify Current User PWD</a></li><li><a href=#modify-user-pwd>Modify User PWD</a></li></ul></li><li><a href=#login-management>Login Management</a><ul><li><a href=#disable-pwd-login>Disable PWD Login</a></li><li><a href=#enable-pwd-login>Enable PWD Login</a></li><li><a href=#disable-ssh-auth>Disable SSH Auth</a></li><li><a href=#enable-ssh-auth>Enable SSH Auth</a></li></ul></li><li><a href=#userdel>Userdel</a><ul><li><a href=#delete-user-only>Delete User Only</a></li><li><a href=#with-home-and-mail>With Home and Mail</a></li></ul></li><li><a href=#adduser-package>Adduser Package</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>User Management</h1><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><a href=#user-account>User Account</a><ul><li><a href=#etcpasswd>/etc/passwd</a></li><li><a href=#etcshadow>/etc/shadow</a></li></ul></li><li><a href=#useradd>Useradd</a><ul><li><a href=#home-directory>HOME Directory</a></li><li><a href=#default-configuration>Default Configuration</a></li><li><a href=#etcdefaultuseradd>/etc/default/useradd</a></li><li><a href=#etclogindefs>/etc/login.defs</a></li><li><a href=#modify-conf-by-cmd>Modify Conf By Cmd</a></li></ul></li><li><a href=#usermod>Usermod</a><ul><li><a href=#modify-user-login-name>Modify User Login Name</a></li><li><a href=#add-user-to-a-group>Add User to a Group</a></li><li><a href=#modify-user-default-shell>Modify User Default Shell</a></li><li><a href=#modify-user-id>Modify User ID</a></li></ul></li><li><a href=#passwd>Passwd</a><ul><li><a href=#modify-current-user-pwd>Modify Current User PWD</a></li><li><a href=#modify-user-pwd>Modify User PWD</a></li></ul></li><li><a href=#login-management>Login Management</a><ul><li><a href=#disable-pwd-login>Disable PWD Login</a></li><li><a href=#enable-pwd-login>Enable PWD Login</a></li><li><a href=#disable-ssh-auth>Disable SSH Auth</a></li><li><a href=#enable-ssh-auth>Enable SSH Auth</a></li></ul></li><li><a href=#userdel>Userdel</a><ul><li><a href=#delete-user-only>Delete User Only</a></li><li><a href=#with-home-and-mail>With Home and Mail</a></li></ul></li><li><a href=#adduser-package>Adduser Package</a></li></ul></nav></div></details></nav><h2 id=user-account>User Account<a href=#user-account class=anchor aria-hidden=true>#</a></h2><h3 id=etcpasswd>/etc/passwd<a href=#etcpasswd class=anchor aria-hidden=true>#</a></h3><p>Linux uses the <code>/etc/passwd</code> file to store user account information.
Because many service processes need to read user account information, you can see that the file&rsquo;s permissions are all readable.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>2010</span> Aug <span class=m>24</span> 15:12 /etc/passwd</span></span></code></pre></div></figure></div><p>View the account information of a user.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>grep kuga /etc/passwd</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kuga:x:1000:1000:,,,:/home/kuga:/bin/bash</span></span></code></pre></div></figure></div><table><thead><tr><th style=text-align:left>KEY</th><th style=text-align:left>VALUE</th></tr></thead><tbody><tr><td style=text-align:left>Username</td><td style=text-align:left>kuga</td></tr><tr><td style=text-align:left>User Password</td><td style=text-align:left>x</td></tr><tr><td style=text-align:left>User ID</td><td style=text-align:left>1000</td></tr><tr><td style=text-align:left>User Group ID</td><td style=text-align:left>1000</td></tr><tr><td style=text-align:left>Remark Field</td><td style=text-align:left>,,,</td></tr><tr><td style=text-align:left>Directory Location</td><td style=text-align:left>/home/kuga</td></tr><tr><td style=text-align:left>Default Shell</td><td style=text-align:left>/bin/bash</td></tr></tbody></table><p>The system will reserve a certain range of UID, and the new user ID added to Ubuntu starts from 1000.
The following command will sort by the third field UID in reverse order, then output the first 10 lines, and only display 136 fields (username, UID, directory location).</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sort -t <span class=s1>&#39;:&#39;</span> -k <span class=m>3</span> -nr /etc/passwd <span class=p>|</span> cut -d <span class=s1>&#39;:&#39;</span> -f1,3,6 <span class=p>|</span> head -n <span class=m>10</span></span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nobody:65534:/nonexistent
</span></span><span class=line><span class=cl>soda:1001:/home/soda
</span></span><span class=line><span class=cl>kuga:1000:/home/kuga
</span></span><span class=line><span class=cl>lxd:999:/var/snap/lxd/common/lxd
</span></span><span class=line><span class=cl>ecs-instance-connect:998:/home/ecs-instance-connect
</span></span><span class=line><span class=cl>fwupd-refresh:115:/run/systemd
</span></span><span class=line><span class=cl>_chrony:114:/var/lib/chrony
</span></span><span class=line><span class=cl>usbmux:112:/var/lib/usbmux
</span></span><span class=line><span class=cl>landscape:111:/var/lib/landscape
</span></span><span class=line><span class=cl>tss:110:/var/lib/tpm</span></span></code></pre></div></figure></div><h3 id=etcshadow>/etc/shadow<a href=#etcshadow class=anchor aria-hidden=true>#</a></h3><p>For historical reasons, the early user passwords were stored in <code>/etc/passwd</code>, so the file name is passwd.
Later, because passwords are easy to crack, the current passwords have been moved to the new file <code>/etc/shadow</code>.
<strong>This file is only readable by root and shadow group</strong>.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-rw-r----- <span class=m>1</span> root shadow <span class=m>1255</span> Aug <span class=m>24</span> 15:08 /etc/shadow</span></span></code></pre></div></figure></div><p>You can roughly look at the contents of this file.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root:*:19955:0:99999:7:::
</span></span><span class=line><span class=cl>daemon:*:19103:0:99999:7:::
</span></span><span class=line><span class=cl>bin:*:19103:0:99999:7:::
</span></span><span class=line><span class=cl>sys:*:19103:0:99999:7:::
</span></span><span class=line><span class=cl>sync:*:19103:0:99999:7:::</span></span></code></pre></div></figure></div><p>These fields are generally related to password management (such as how many days must be changed), which is not expanded here.</p><h2 id=useradd>Useradd<a href=#useradd class=anchor aria-hidden=true>#</a></h2><h3 id=home-directory>HOME Directory<a href=#home-directory class=anchor aria-hidden=true>#</a></h3><p>By default, the user directory is not created.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>useradd foo</span></span></code></pre></div></figure></div><p>Use the <code>-m</code> parameter to create the user directory.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>useradd -m foo</span></span></code></pre></div></figure></div><p>Use the <code>-M</code> parameter to not create the user directory.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>useradd -M foo</span></span></code></pre></div></figure></div><h3 id=default-configuration>Default Configuration<a href=#default-configuration class=anchor aria-hidden=true>#</a></h3><p>Use the -D option to view the default configuration used when adding a user.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>useradd -D</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>GROUP</span><span class=o>=</span><span class=m>100</span>
</span></span><span class=line><span class=cl><span class=nv>HOME</span><span class=o>=</span>/home
</span></span><span class=line><span class=cl><span class=nv>INACTIVE</span><span class=o>=</span>-1
</span></span><span class=line><span class=cl><span class=nv>EXPIRE</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>SHELL</span><span class=o>=</span>/bin/sh
</span></span><span class=line><span class=cl><span class=nv>SKEL</span><span class=o>=</span>/etc/skel
</span></span><span class=line><span class=cl><span class=nv>CREATE_MAIL_SPOOL</span><span class=o>=</span>no</span></span></code></pre></div></figure></div><ul><li>GROUP: User default group ID.</li><li>HOME: User directory location.</li><li>INACTIVE: Number of days to disable the account after the password expires.</li><li>EXPIRE: Account expiration date.</li><li>SHELL: Default login Shell used.</li><li>SKEL: Skeletal, the contents of this directory will be copied to the user&rsquo;s home directory.</li><li>CREATE_MAIL_SPOOL: Whether to create a mail storage file.</li></ul><h3 id=etcdefaultuseradd>/etc/default/useradd<a href=#etcdefaultuseradd class=anchor aria-hidden=true>#</a></h3><p>The default configuration file for the <code>useradd</code> command.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>1118</span> Aug <span class=m>28</span> 10:58 /etc/default/useradd</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /etc/default/useradd <span class=p>|</span> head -n <span class=m>20</span></span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Default values for useradd(8)</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># The SHELL variable specifies the default login shell on your</span>
</span></span><span class=line><span class=cl><span class=c1># system.</span>
</span></span><span class=line><span class=cl><span class=c1># Similar to DSHELL in adduser. However, we use &#34;sh&#34; here because</span>
</span></span><span class=line><span class=cl><span class=c1># useradd is a low level utility and should be as general</span>
</span></span><span class=line><span class=cl><span class=c1># as possible</span>
</span></span><span class=line><span class=cl><span class=nv>SHELL</span><span class=o>=</span>/bin/sh
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># The default group for users</span>
</span></span><span class=line><span class=cl><span class=c1># 100=users on Debian systems</span>
</span></span><span class=line><span class=cl><span class=c1># Same as USERS_GID in adduser</span>
</span></span><span class=line><span class=cl><span class=c1># This argument is used when the -n flag is specified.</span>
</span></span><span class=line><span class=cl><span class=c1># The default behavior (when -n and -g are not specified) is to create a</span>
</span></span><span class=line><span class=cl><span class=c1># primary user group with the same name as the user being added to the</span>
</span></span><span class=line><span class=cl><span class=c1># system.</span>
</span></span><span class=line><span class=cl><span class=c1># GROUP=100</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># The default home directory. Same as DHOME for adduser</span>
</span></span><span class=line><span class=cl><span class=c1># HOME=/home</span></span></span></code></pre></div></figure></div><p>If you change the SHELL to <code>/bin/bash</code>, then <code>useradd -D</code> will be automatically updated.</p><h3 id=etclogindefs>/etc/login.defs<a href=#etclogindefs class=anchor aria-hidden=true>#</a></h3><p>The core configuration file for user account and login management.
Functions include: password policy, UID/GID range, HOME directory management, user and group management, login settings, etc.
Settings in the file will affect the behavior of commands such as <code>useradd</code>, <code>usermod</code>, <code>passwd</code>, etc., it is recommended to back up before making changes.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>10734</span> Nov <span class=m>11</span>  <span class=m>2021</span> /etc/login.defs</span></span></code></pre></div></figure></div><p>Take a look at the <code>USERGROUPS_ENAB</code> parameter separately.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>grep -B <span class=m>4</span> -E <span class=s2>&#34;USERGROUPS_ENAB (yes|no)&#34;</span> /etc/login.defs</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># If set to yes, userdel will remove the user&#39;s group if it contains no</span>
</span></span><span class=line><span class=cl><span class=c1># more members, and useradd will create by default a group with the name</span>
</span></span><span class=line><span class=cl><span class=c1># of the user.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl>USERGROUPS_ENAB yes</span></span></code></pre></div></figure></div><p>If the value of <code>USERGROUPS_ENAB</code> is yes:</p><ul><li><code>userdel</code>: When deleting a user, it will also delete the empty user group.</li><li><code>useradd</code>: When creating a user, it will also create a group with the same name as the user.</li></ul><p>This is why the default parameter <code>GROUP=100</code> was not used when creating a user.</p><h3 id=modify-conf-by-cmd>Modify Conf By Cmd<a href=#modify-conf-by-cmd class=anchor aria-hidden=true>#</a></h3><p>Modify the default login Shell.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo useradd -D -s /bin/bash</span></span></code></pre></div></figure></div><p>Modify the default group ID.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo useradd -D -g <span class=m>100</span></span></span></code></pre></div></figure></div><p>Modify the default HOME directory.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo useradd -D -b path</span></span></code></pre></div></figure></div><p>After executing the command, you will find that the file permissions have changed from <code>644</code> to <code>600</code>.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-rw------- <span class=m>1</span> root root <span class=m>1195</span> Aug <span class=m>28</span> 11:22 /etc/default/useradd</span></span></code></pre></div></figure></div><p>The corrected permissions are as follows.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chmod <span class=m>644</span> /etc/default/useradd</span></span></code></pre></div></figure></div><p><a href=https://github.com/shadow-maint/shadow/blob/5c0b99c77e3963cc3d4ee4980b0bb3c9955c032c/src/useradd.c#L525>Look at the source code</a>, the execution process in the <code>set_defaults(void)</code> method is roughly as follows:</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl> * set_defaults - write new defaults file
</span></span><span class=line><span class=cl> *
</span></span><span class=line><span class=cl> * set_defaults<span class=o>()</span> re-writes the defaults file using the values that
</span></span><span class=line><span class=cl> * are currently set. Duplicated lines are pruned, missing lines are
</span></span><span class=line><span class=cl> * added, and unrecognized lines are copied as is.
</span></span><span class=line><span class=cl> */
</span></span><span class=line><span class=cl>static int
</span></span><span class=line><span class=cl>set_defaults<span class=o>(</span>void<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div></figure></div><ul><li>Use the <code>mkstemp</code> function to create a temporary file A.</li><li>Process the <code>/etc/default/useradd</code> file and copy it to A.</li><li>Backup the original <code>useradd</code> file, <strong>rename</strong> it to <code>useradd-</code>.</li><li>Overwrite the A file with the original <code>useradd</code> file.</li><li><strong>The file created by the <code>mkstemp</code> function has permissions of <code>0600</code></strong>.</li></ul><p>Check the <code>useradd</code> and its backup <code>useradd-</code> files.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls -li /etc/default/useradd*</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>655124</span> -rw------- <span class=m>1</span> root root <span class=m>1197</span> Aug <span class=m>28</span> 16:28 /etc/default/useradd
</span></span><span class=line><span class=cl><span class=m>655237</span> -rw------- <span class=m>1</span> root root <span class=m>1197</span> Aug <span class=m>28</span> 16:07 /etc/default/useradd-</span></span></code></pre></div></figure></div><p>If you use the command to modify the default login Shell.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo useradd -D -s /bin/sh</span></span></code></pre></div></figure></div><p>Check the inode of the two files again.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=m>655454</span> -rw------- <span class=m>1</span> root root <span class=m>1195</span> Aug <span class=m>28</span> 17:27 /etc/default/useradd
</span></span><span class=line><span class=cl><span class=m>655124</span> -rw------- <span class=m>1</span> root root <span class=m>1197</span> Aug <span class=m>28</span> 16:28 /etc/default/useradd-</span></span></code></pre></div></figure></div><p>It is not difficult to find that the inode of <code>useradd-</code> is the same as the inode of <code>useradd</code> before the modification.
The issue of permissions being modified is obviously unreasonable, the command should not modify the file permissions.
You can check this <a href=https://github.com/shadow-maint/shadow/pull/1083>pull request</a> on GitHub.</p><h2 id=usermod>Usermod<a href=#usermod class=anchor aria-hidden=true>#</a></h2><h3 id=modify-user-login-name>Modify User Login Name<a href=#modify-user-login-name class=anchor aria-hidden=true>#</a></h3><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo usermod -l newuser olduser</span></span></code></pre></div></figure></div><h3 id=add-user-to-a-group>Add User to a Group<a href=#add-user-to-a-group class=anchor aria-hidden=true>#</a></h3><p>The <code>-a</code> means to append to the group, not to replace the current group list.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo usermod -aG group user</span></span></code></pre></div></figure></div><h3 id=modify-user-default-shell>Modify User Default Shell<a href=#modify-user-default-shell class=anchor aria-hidden=true>#</a></h3><p><code>usermod</code> does not check the legality of the Shell, you can use <code>chsh</code> instead.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chsh -s /bin/bash user</span></span></code></pre></div></figure></div><h3 id=modify-user-id>Modify User ID<a href=#modify-user-id class=anchor aria-hidden=true>#</a></h3><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo usermod -u newuid user</span></span></code></pre></div></figure></div><h2 id=passwd>Passwd<a href=#passwd class=anchor aria-hidden=true>#</a></h2><h3 id=modify-current-user-pwd>Modify Current User PWD<a href=#modify-current-user-pwd class=anchor aria-hidden=true>#</a></h3><p>Without parameters, it is to change the password of the current user.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>passwd</span></span></code></pre></div></figure></div><h3 id=modify-user-pwd>Modify User PWD<a href=#modify-user-pwd class=anchor aria-hidden=true>#</a></h3><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo passwd soda</span></span></code></pre></div></figure></div><h2 id=login-management>Login Management<a href=#login-management class=anchor aria-hidden=true>#</a></h2><h3 id=disable-pwd-login>Disable PWD Login<a href=#disable-pwd-login class=anchor aria-hidden=true>#</a></h3><p>The following two methods are the same, and <strong>will not disable SSH public key authentication</strong>.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo usermod -L user</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo passwd -l user</span></span></code></pre></div></figure></div><p>After execution, the password field in the <code>/etc/shadow</code> file will be prefixed with <code>!</code>.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo grep user /etc/shadow</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>user:!<span class=nv>$y</span>...:19959:0:99999:7:::</span></span></code></pre></div></figure></div><h3 id=enable-pwd-login>Enable PWD Login<a href=#enable-pwd-login class=anchor aria-hidden=true>#</a></h3><p>The following two methods are the same, and can be used together.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo usermod -U user</span></span></code></pre></div></figure></div><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo passwd -u user</span></span></code></pre></div></figure></div><p>After execution, the password field in the <code>/etc/shadow</code> file will delete the <code>!</code> prefix.</p><h3 id=disable-ssh-auth>Disable SSH Auth<a href=#disable-ssh-auth class=anchor aria-hidden=true>#</a></h3><p>Without a login Shell, naturally the password cannot be used for login.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo usermod -s /usr/sbin/nologin user</span></span></code></pre></div></figure></div><h3 id=enable-ssh-auth>Enable SSH Auth<a href=#enable-ssh-auth class=anchor aria-hidden=true>#</a></h3><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo usermod -s /bin/bash user</span></span></code></pre></div></figure></div><h2 id=userdel>Userdel<a href=#userdel class=anchor aria-hidden=true>#</a></h2><h3 id=delete-user-only>Delete User Only<a href=#delete-user-only class=anchor aria-hidden=true>#</a></h3><p>This method only deletes the user and keeps the main directory.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo userdel user</span></span></code></pre></div></figure></div><h3 id=with-home-and-mail>With Home and Mail<a href=#with-home-and-mail class=anchor aria-hidden=true>#</a></h3><p>Not only delete the user, but also delete the main directory and mail.</p><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight frame=none><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo userdel -r user</span></span></code></pre></div></figure></div><p>If a file or directory does not exist, a prompt will appear in the terminal.</p><h2 id=adduser-package>Adduser Package<a href=#adduser-package class=anchor aria-hidden=true>#</a></h2><p>This package provides two useful commands, <code>adduser</code> and <code>deluser</code>, which are high-level encapsulated tools.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/en/linux/env/shebang/ class="stretched-link text-reset text-decoration-none">Shebang</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/en/linux/perm/group-mgmt/ class="stretched-link text-reset text-decoration-none">Group Management</a></div><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=https://beian.miit.gov.cn/>粤ICP备2024312555号-1</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://thulite.io/>Thulite</a></li></ul></div></div></div></footer><script async src=/js/app.c17553444ec7c62f781ddbaa011948f6d85a1bab49420047d68a2b89852a8b36.js integrity="sha256-wXVTRE7Hxi94HduqARlI9thaG6tJQgBH1ooriYUqizY="></script><script async src=/js/flexsearch.en.8f9113291e072f5d0074cc2b714e01be1d0d0e9f3fecfc7f8a004d30f06ee98e.js integrity="sha256-j5ETKR4HL10AdMwrcU4Bvh0NDp8/7Px/igBNMPBu6Y4="></script><script async src=/js/search-modal.0415aa45353ab123a509f6ddc6861549ece898b90872fcf757cd2663041dac96.js integrity="sha256-BBWqRTU6sSOlCfbdxoYVSezomLkIcvz3V80mYwQdrJY="></script></body></html>