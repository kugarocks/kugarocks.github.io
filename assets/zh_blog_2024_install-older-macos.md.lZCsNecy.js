import{_ as i,a,b as h,c as l}from"./chunks/software-signing.CMOG0wEA.js";import{_ as n,c as t,o as k,ah as e}from"./chunks/framework.HzbgFGQH.js";const B=JSON.parse('{"title":"安装旧版 macOS","description":"","frontmatter":{},"headers":[],"relativePath":"zh/blog/2024/install-older-macos.md","filePath":"zh/blog/2024/install-older-macos.md","lastUpdated":1746813098000}'),p={name:"zh/blog/2024/install-older-macos.md"};function F(r,s,d,g,c,C){return k(),t("div",null,s[0]||(s[0]=[e('<h1 id="安装旧版-macos" tabindex="-1">安装旧版 macOS <a class="header-anchor" href="#安装旧版-macos" aria-label="Permalink to “安装旧版 macOS”">​</a></h1><h2 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-label="Permalink to “背景”">​</a></h2><p>出于种种原因，要在一台苹果电脑上安装旧版本的 macOS 是一件不容易的事。 因为苹果官网的下载链接会引导你到 App Store， 当它发现你要下载的系统版本比你当前使用的系统还要旧的时候， 是不会提供下载的，只能下载更新的版本。</p><h2 id="证书过期" tabindex="-1">证书过期 <a class="header-anchor" href="#证书过期" aria-label="Permalink to “证书过期”">​</a></h2><p>我在网上随便找了一个 High Sierra 镜像，因为苹果官网根本下载不了旧版本的 macOS。 引导盘做好了之后，一切都很顺利，直到它给我来了个惊喜 。（这个图我是网上找的）</p><p><img src="'+i+'" alt="macos-damaged"></p><p>查了一下资料，很多都说是证书过期的问题，因为以前苹果发布的证书有些是在 2019 年过期的。</p><p><img src="'+a+`" alt="cert-info"></p><h2 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-label="Permalink to “解决方案”">​</a></h2><h3 id="下载最新官方镜像-推荐" tabindex="-1">下载最新官方镜像（推荐） <a class="header-anchor" href="#下载最新官方镜像-推荐" aria-label="Permalink to “下载最新官方镜像（推荐）”">​</a></h3><p>一个镜像能不能用不仅仅是证书的问题，所以最靠谱的方法是从苹果官方下载最新的安装包。 但前面说了 App Store 根本不提供下载， 幸运的是我们可以通过 <code>softwareupdate</code> 这个命令，去下载当前电脑所支持的系统版本。</p><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">softwareupdate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list-full-installers</span></span></code></pre></div><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Finding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> software</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Software</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> full</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> installers:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Sonoma, Version: 14.6, Size: 13339695KiB, Build: 23G80</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Sonoma, Version: 14.5, Size: 13353373KiB, Build: 23F79</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Sonoma, Version: 14.4.1, Size: 13298513KiB, Build: 23E224</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Ventura, Version: 13.6.8, Size: 11922165KiB, Build: 22G820</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Ventura, Version: 13.6.7, Size: 11924125KiB, Build: 22G720</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Ventura, Version: 13.6.6, Size: 11917983KiB, Build: 22G630</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Monterey, Version: 12.7.6, Size: 12118346KiB, Build: 21H1320</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Monterey, Version: 12.7.5, Size: 12116686KiB, Build: 21H1222</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Monterey, Version: 12.7.4, Size: 12117810KiB, Build: 21H1123</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Big Sur, Version: 11.7.10, Size: 12125478KiB, Build: 20G1427</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Catalina, Version: 10.15.7, Size: 8055650KiB, Build: 19H15</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Catalina, Version: 10.15.7, Size: 8055522KiB, Build: 19H2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Catalina, Version: 10.15.6, Size: 8055450KiB, Build: 19G2021</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Mojave, Version: 10.14.6, Size: 5896894KiB, Build: 18G103</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Title: macOS Mojave, Version: 10.14.4, Size: 5894794KiB, Build: 18E2034</span></span></code></pre></div><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">softwareupdate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --fetch-full-installer</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --full-installer-version</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.14.6</span></span></code></pre></div><p>因为我另一台电脑支持的最旧版本是 Mojave，不是 High Sierra，所以最后我安装了 10.14.6。</p><h3 id="安装时修改系统时间" tabindex="-1">安装时修改系统时间 <a class="header-anchor" href="#安装时修改系统时间" aria-label="Permalink to “安装时修改系统时间”">​</a></h3><p>打开 Utilities -&gt; Terminal，使用 <code>date</code> 命令修改时间。</p><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 010101012018</span></span></code></pre></div><p><img src="`+h+`" alt="macos-terminal"></p><h2 id="知其所以然" tabindex="-1">知其所以然 <a class="header-anchor" href="#知其所以然" aria-label="Permalink to “知其所以然”">​</a></h2><p>虽然问题是解决了，但我更想验证一下到底是不是证书过期的问题。</p><ul><li>High Sierra：报错，application is damaged</li><li>Mojave：成功安装</li></ul><p>这两个安装包都是后缀为 <code>.app</code> 的文件（其实也是目录）， 不像上面的 <code>.pkg</code> 文件，直接打开就能看到证书信息，需要使用别的方法。</p><h3 id="查看证书信息" tabindex="-1">查看证书信息 <a class="header-anchor" href="#查看证书信息" aria-label="Permalink to “查看证书信息”">​</a></h3><p>我们可以通过 <code>pkgutil</code> 查看 <code>.app</code> 的证书信息。</p><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pkgutil</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --check-signature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">macOS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">High</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Sierra.app</span></span></code></pre></div><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Install macOS High Sierra&quot;:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Status:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> signed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> by</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> untrusted</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certificate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Chain:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Software</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Signing</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       SHA256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Fingerprint:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           2A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> A4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> B9</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 97</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3B</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7B</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> A0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DD</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 44</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> E4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8B</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 53</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 37</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3A</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 99</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 19</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> E8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0E</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 72</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 82</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> E8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> A7</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 51</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       ------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apple</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Code</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Signing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Certification</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Authority</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       Expires:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2026-10-24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:39:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       SHA256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Fingerprint:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           5B</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> B1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8F</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 68</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 92</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> F5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 65</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> B5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4F</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2E</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 19</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8F</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 71</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           55</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> F7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> E2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> B9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5E</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 05</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1E</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 62</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       ------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    3.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apple</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       Expires:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2035-02-09</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 21:40:36</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       SHA256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Fingerprint:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           B0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> B1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 73</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FF</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 45</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 05</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 14</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2C</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 49</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> F1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 6E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 6B</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2C</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">           68</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> C5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 91</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> B5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> A1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> F0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 24</span></span></code></pre></div><p>可以看到，这里面的证书信息包含了 3 个部份，但只有 2，3 部份有过期信息，且均没过期。 更离谱的是，我也查了 Mojave 的证书信息，和上面的 High Sierra 是一模一样的。 那到底是什么问题？后来我发现可以使用 <code>codesign</code> 查看更详细的证书信息。</p><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">codesign</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --display</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --extract-certificates</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">macOS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">High</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Sierra.app</span></span></code></pre></div><p>这个命令会在当前目录生成 3 个证书文件。</p><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">codesign0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> codesign1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> codesign2</span></span></code></pre></div><p>再使用 <code>qlmanage</code> 命令查看证书信息。</p><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">qlmanage</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public.x509-certificate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> codesign0</span></span></code></pre></div><p><img src="`+l+'" alt="software-signing"></p><p>可以看到 Software Signing 的过期时间是 2021 年 4 月 13 日， 也正是上面 <code>pkgutil</code> 第一部份所缺失的信息。 当我以为真相大白的时候，同样的命令，Mojave 也的过期时间也是 2021 年 4 月 13 日。 这我就不懂了，那应该两个安装包都不行才对吧，然后我又问了一下 ChatGPT。</p><blockquote><p>🤡：为什么 macos 的安装程序中 Software Signing 证书过期，还能正常运行</p><p>🤖：在 macOS 中，安装程序中的 Software Signing 证书过期后依然能够正常运行的原因是因为系统的设计方式。在创建安装程序时，只要证书在签署时是有效的，macOS 会忽略证书的过期日期，从而允许已签署的应用程序继续运行。以下是具体原因：</p><ol><li><strong>签署时的有效性</strong>：在安装程序创建时，只要证书是有效的，签署过程就会成功完成。这意味着安装程序在创建时已经被认证为安全的，即使之后证书过期，系统依然认可该签署的合法性。</li><li><strong>系统设计</strong>：macOS 的设计理念是为了确保应用程序的连续性和用户体验的稳定性。为了避免因证书过期而导致用户无法使用已安装的应用程序，macOS 在运行时会忽略已签署应用程序的证书过期问题。</li><li><strong>减少用户和开发者的负担</strong>：如果每次证书过期都要求用户重新安装应用程序，或者开发者必须频繁更新证书，这将给用户和开发者带来极大的不便。忽略过期证书可以避免这种情况，确保用户能够持续使用他们依赖的应用程序。</li><li><strong>实际操作中的容错性</strong>：虽然理论上证书有有效期，但实际操作中，macOS 的容错性设计允许过期证书签署的应用程序继续运行。这种设计是为了确保系统的灵活性和可靠性。</li></ol><p>综上所述，macOS 的安装程序中，Software Signing 证书过期后依然能够正常运行，是由于系统在签署时验证有效性，并在运行时忽略证书过期日期，从而确保应用程序的连续性和用户体验的稳定性。</p></blockquote><p>所以到这里我是不是可以认为两个安装包的证书都是没问题的？</p><h3 id="apple-installer-checksums" tabindex="-1">Apple Installer Checksums <a class="header-anchor" href="#apple-installer-checksums" aria-label="Permalink to “Apple Installer Checksums”">​</a></h3><p>似乎我们还可以验证一下安装包的完整性，<a href="https://github.com/notpeter/apple-installer-checksums" target="_blank" rel="noreferrer">Mac OSX Installers SHA1 Checksums</a>。</p><div class="language-bash"><button title="复制代码" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">shasum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /Applications/Install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.app/Contents/SharedSupport/{Base,Install}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.dmg</span></span></code></pre></div><p>但我都试了，结果是一样的，这也代表不了什么。</p><h3 id="真相到底是什么" tabindex="-1">真相到底是什么 <a class="header-anchor" href="#真相到底是什么" aria-label="Permalink to “真相到底是什么”">​</a></h3><blockquote><p>It doesn&#39;t work，but I don&#39;t know why.</p></blockquote><p>事情发展到这里，我已经不知道是什么原因导致 High Sierra 安装包报错了。</p><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to “参考”">​</a></h2><ul><li><a href="https://eclecticlight.co/2019/10/18/beware-apple-security-certificates-after-24-october-they-may-have-expired/" target="_blank" rel="noreferrer">https://eclecticlight.co/2019/10/18/beware-apple-security-certificates-after-24-october-they-may-have-expired/</a></li><li><a href="https://www.youtube.com/watch?v=E4Mu4tI8-iw" target="_blank" rel="noreferrer">https://www.youtube.com/watch?v=E4Mu4tI8-iw</a></li><li><a href="https://github.com/notpeter/apple-installer-checksums" target="_blank" rel="noreferrer">https://github.com/notpeter/apple-installer-checksums</a></li></ul>',46)]))}const E=n(p,[["render",F]]);export{B as __pageData,E as default};
